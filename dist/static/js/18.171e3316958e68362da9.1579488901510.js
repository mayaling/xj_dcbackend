webpackJsonp([18],{Kng5:function(e,t){},akmH:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Vue.directive("loadmore",{bind:function(e,t){e.querySelector(".el-select-dropdown .el-select-dropdown__wrap").addEventListener("scroll",function(){this.scrollHeight-this.scrollTop<=this.clientHeight&&t.value()})}});var o={name:"addcanal",data:function(){return{form:{name:"",app_url:"",startDate:"",expDate:"",amt:"",memo:"",cooperation_type:"",template:"",admin_name:"",admin_id:""},page:1,pageCount:"",admindata:"",tableData:"",templatedata:[{id:1,name:"默认模板"}],typedata:[{id:1,name:"UV"},{id:2,name:"注册"},{id:3,name:"激活"},{id:4,name:"其它"}],rules:{name:[{required:!0,message:"不可为空！",trigger:"blur"}],admin_id:[{required:!0,message:"不可为空！",trigger:["blur","change"]}],template:[{required:!0,message:"不可为空！",trigger:["blur","change"]}],cooperation_type:[{required:!0,message:"不可为空！",trigger:["blur","change"]}]}}},created:function(){this.id=this.$route.query.id,this.getadmindata(),this.id&&this.getformdata()},computed:{},methods:{loadMore:function(){var e=this;console.log(2222);var t=this;t.page!=t.pageCount?(t.page++,this.$get("admins?type=3&status=1&sort=-id&page="+t.page).then(function(a){if(1===a.code)for(var o=0;o<a.info.items.length;o++)t.admindata.push(a.info.items[o]);else e.$message.error("数据获取失败")}).catch(function(){e.loading=!1})):t.page=t.pageCount},getadmindata:function(){var e=this;this.$get("admins?type=3&status=1&sort=-id").then(function(t){console.log(t),1===t.code?(e.admindata=t.info.items,e.pageCount=t.info._meta.pageCount,console.log(e.admindata)):e.$message.error("数据加载失败"),e.loading=!1}).catch(function(){e.loading=!1})},getformdata:function(){var e=this;this.$get("channels/"+this.id).then(function(t){console.log(t),1===t.code?(e.tableData=t.info,console.log(e.tableData),e.form=e.tableData,console.log(e.form)):e.$message.error("数据加载失败"),e.loading=!1}).catch(function(){e.loading=!1})},onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message.error("请完善红色提示内容"),!1;t.$post("channels",{name:t.form.name,admin_id:t.form.admin_id,cooperation_type:t.form.cooperation_type,app_url:t.form.app_url,template:t.form.template}).then(function(e){1===e.code?(t.$message({message:e.message,type:"success"}),t.$router.push("/canallist")):t.$message.error(e.message)})})},onEdit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message.error("请完善红色提示内容"),!1;t.$put("channels/"+t.id,{name:t.form.name,admin_id:t.form.admin_id,cooperation_type:t.form.cooperation_type,app_url:t.form.app_url,template:t.form.template}).then(function(e){1===e.code?(t.$message({message:e.message,type:"success"}),t.$router.push("/canallist")):t.$message.error(e.message)})})},resetForm:function(e){this.$refs[e].resetFields()}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table",attrs:{"element-loading-text":"加载中"}},[a("div",{staticClass:"container"},[a("div",{staticClass:"container-title"},[e._v("新增渠道")]),e._v(" "),a("el-form",{ref:"form",staticClass:"item-add-list",attrs:{model:e.form,rules:e.rules}},[a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"渠道名称:",prop:"name"}},[a("el-input",{attrs:{type:"text"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"==typeof t?t.trim():t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"APP下载链接:",prop:"app_url"}},[a("el-input",{model:{value:e.form.app_url,callback:function(t){e.$set(e.form,"app_url","string"==typeof t?t.trim():t)},expression:"form.app_url"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"渠道联系人名称",prop:"admin_id"}},[a("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.loadMore,expression:"loadMore"}],attrs:{placeholder:"请选择联系人名称",filterable:""},model:{value:e.form.admin_id,callback:function(t){e.$set(e.form,"admin_id",t)},expression:"form.admin_id"}},[e._l(e.admindata,function(e){return[a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})]})],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"渠道模板类型",prop:"template"}},[a("el-select",{attrs:{placeholder:"请选择模板类型"},model:{value:e.form.template,callback:function(t){e.$set(e.form,"template",t)},expression:"form.template"}},[e._l(e.templatedata,function(e){return[a("el-option",{attrs:{label:e.name,value:e.id}})]})],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"合作方式",prop:"cooperation_type"}},[a("el-select",{attrs:{placeholder:"请选择合作方式"},model:{value:e.form.cooperation_type,callback:function(t){e.$set(e.form,"cooperation_type",t)},expression:"form.cooperation_type"}},[e._l(e.typedata,function(e){return[a("el-option",{attrs:{label:e.name,value:e.id}})]})],2)],1),e._v(" "),e.tableData?e._e():a("el-button",{staticStyle:{"margin-top":"40px"},attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("提交")]),e._v(" "),e.tableData?a("el-button",{staticStyle:{"margin-top":"40px"},attrs:{type:"primary"},on:{click:function(t){return e.onEdit("form")}}},[e._v("保存")]):e._e(),e._v(" "),a("router-link",{attrs:{to:{path:"canallist"}}},[a("el-button",{attrs:{type:"primary"}},[e._v("取消")])],1)],1),e._v(" "),a("el-col",{attrs:{span:6}}),e._v(" "),a("el-col",{attrs:{span:6}})],1)],1)],1)])},staticRenderFns:[]};var n=a("C7Lr")(o,r,!1,function(e){a("Kng5")},"data-v-6ef89c4c",null);t.default=n.exports}});